!function(n){"object"==typeof exports&&"object"==typeof module?n(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","diff_match_patch"],n):n(CodeMirror)}(function(n){function E(a,b){this.mv=a;this.type=b;this.classes="left"==b?{chunk:"CodeMirror-merge-l-chunk",start:"CodeMirror-merge-l-chunk-start",end:"CodeMirror-merge-l-chunk-end",insert:"CodeMirror-merge-l-inserted",del:"CodeMirror-merge-l-deleted",connect:"CodeMirror-merge-l-connect"}:{chunk:"CodeMirror-merge-r-chunk",
start:"CodeMirror-merge-r-chunk-start",end:"CodeMirror-merge-r-chunk-end",insert:"CodeMirror-merge-r-inserted",del:"CodeMirror-merge-r-deleted",connect:"CodeMirror-merge-r-connect"}}function C(a){a.diffOutOfDate&&(a.diff=R(a.orig.getValue(),a.edit.getValue(),a.mv.options.ignoreWhitespace),a.chunks=S(a.diff),a.diffOutOfDate=!1,n.signal(a.edit,"updateDiff",a.diff))}function D(a,b){if(a.diffOutOfDate)a.lockScroll&&null==a.needsScrollSync&&(a.needsScrollSync=b);else{if(a.needsScrollSync=null,!a.lockScroll)return 1;
var c=+new Date,e=b?(d=a.edit,a.orig):(d=a.orig,a.edit);if(!(d.state.scrollSetBy==a&&(d.state.scrollSetAt||0)+250>c)){var g,f,h,d,l,k,m=d.getScrollInfo();if("align"==a.mv.options.connect)h=m.top;else{g=.5*m.clientHeight;f=m.top+g;k=d.lineAtHeight(f,"local");for(var p=a.chunks,w,u,n,r,v=0;v<p.length;v++){var t=p[v],q=b?t.editFrom:t.origFrom,y=b?t.editTo:t.origTo;null==u&&(k<q?(u=t.editFrom,r=t.origFrom):k<y&&(u=t.editTo,r=t.origTo));y<=k?(w=t.editTo,n=t.origTo):q<=k&&(w=t.editFrom,n=t.origFrom)}k=
{edit:{before:w,after:u},orig:{before:n,after:r}};d=T(d,b?k.edit:k.orig);k=T(e,b?k.orig:k.edit);d=(f-d.top)/(d.bot-d.top);(h=k.top-g+d*(k.bot-k.top))>m.top&&1>(l=m.top/g)?h=h*l+m.top*(1-l):(d=m.height-m.clientHeight-m.top)<g&&d<(k=e.getScrollInfo()).height-k.clientHeight-h&&1>(l=d/g)&&(h=h*l+(k.height-k.clientHeight-d)*(1-l))}return e.scrollTo(m.left,h),e.state.scrollSetAt=c,e.state.scrollSetBy=a,1}}}function T(a,b){var c=b.after;return null==c&&(c=a.lastLine()+1),{top:a.heightAtLine(b.before||0,
"local"),bot:a.heightAtLine(c,"local")}}function U(a,b,c){(a.lockScroll=b)&&0!=c&&D(a,DIFF_INSERT)&&B(a);(b?n.addClass:n.rmClass)(a.lockButton,"CodeMirror-merge-scrolllock-enabled")}function K(a,b,c){for(var e=0;e<b.length;++e){var g=b[e];if(g instanceof n.TextMarker)g.clear();else if(g.parent)for(var f=a,h=c,d=h.classLocation,l=0;l<d.length;l++)f.removeLineClass(g,d[l],h.chunk),f.removeLineClass(g,d[l],h.start),f.removeLineClass(g,d[l],h.end)}b.length=0}function V(a,b,c,e,g){var f=a.getViewport();
a.operation(function(){c.from==c.to||20<f.from-c.to||20<c.from-f.to?(K(a,c.marked,g),L(a,b,e,c.marked,f.from,f.to,g),c.from=f.from,c.to=f.to):(f.from<c.from&&(L(a,b,e,c.marked,f.from,c.from,g),c.from=f.from),f.to>c.to&&(L(a,b,e,c.marked,c.to,f.to,g),c.to=f.to))})}function M(a,b,c,e,g,f){var h=c.classLocation;b=a.getLineHandle(b);for(var d=0;d<h.length;d++)e&&a.addLineClass(b,h[d],c.chunk),g&&a.addLineClass(b,h[d],c.start),f&&a.addLineClass(b,h[d],c.end);return b}function L(a,b,c,e,g,f,h){function d(b,
c){for(var d=Math.max(g,b),k=Math.min(f,c),m=d;m<k;++m)e.push(M(a,m,h,!0,m==b,m==c-1));b==c&&d==c&&k==c&&(d?e.push(M(a,d-1,h,!1,!1,!0)):e.push(M(a,d,h,!1,!0,!1)))}for(var l=x(0,0),k=x(g,0),m=a.clipPos(x(f-1)),p=c==DIFF_DELETE?h.del:h.insert,w=0,u=!1,n=0;n<b.length;++n){var r,v,t=b[n],q=t[0],y=t[1];q==DIFF_EQUAL?(v=l.line+(W(b,n)?0:1),F(l,y),v<(r=l.line+(X(b,n)?1:0))&&(u&&(d(w,v),u=!1),w=r)):(u=!0,q==c&&(t=F(l,y,!0),v=l,q=0<((r=k).line-v.line||r.ch-v.ch)?r:v,y=t,v=0>((r=m).line-y.line||r.ch-y.ch)?
r:y,r=v,(y=q).line==r.line&&y.ch==r.ch||e.push(a.markText(q,v,{className:p})),l=t))}u&&d(w,l.line+1)}function B(a){if(a.showDifferences){var b;a.svg&&(G(a.svg),b=a.gap.offsetWidth,Y(a.svg,"width",b,"height",a.gap.offsetHeight));a.copyButtons&&G(a.copyButtons);for(var c,e,g,f,h,d,l,k,m,p,w,u=a.edit.getViewport(),n=a.orig.getViewport(),r=a.mv.wrap.getBoundingClientRect().top,v=r-a.edit.getScrollerElement().getBoundingClientRect().top+a.edit.getScrollInfo().top,r=r-a.orig.getScrollerElement().getBoundingClientRect().top+
a.orig.getScrollInfo().top,t=0;t<a.chunks.length;t++){var q=a.chunks[t];q.editFrom<=u.to&&q.editTo>=u.from&&q.origFrom<=n.to&&q.origTo>=n.from&&(c=q,e=r,g=v,f=b,w=p=m=k=l=d=h=void 0,p="left"==(q=a).type,w=q.orig.heightAtLine(c.origFrom,"local",!0)-e,q.svg&&(l=w,h=q.edit.heightAtLine(c.editFrom,"local",!0)-g,p&&(d=l,l=h,h=d),k=q.orig.heightAtLine(c.origTo,"local",!0)-e,m=q.edit.heightAtLine(c.editTo,"local",!0)-g,p&&(d=k,k=m,m=d),l=" C "+f/2+" "+h+" "+f/2+" "+l+" "+(f+2)+" "+l,m=" C "+f/2+" "+k+" "+
f/2+" "+m+" -1 "+m,Y(q.svg.appendChild(document.createElementNS("http://www.w3.org/2000/svg","path")),"d","M -1 "+h+l+" L "+(f+2)+" "+k+m+" z","class",q.classes.connect)),q.copyButtons&&(k=q.copyButtons.appendChild(z("div","left"==q.type?"⇝":"⇜","CodeMirror-merge-copy")),m=q.mv.options.allowEditingOriginals,k.title=q.edit.phrase(m?"Push to left":"Revert chunk"),k.chunk=c,k.style.top=(c.origTo>c.origFrom?w:q.edit.heightAtLine(c.editFrom,"local")-g)+"px",k.setAttribute("role","button"),m&&(m=q.edit.heightAtLine(c.editFrom,
"local")-g,(g=q.copyButtons.appendChild(z("div","right"==q.type?"⇝":"⇜","CodeMirror-merge-copy-reverse"))).title="Push to right",g.chunk={editFrom:c.origFrom,editTo:c.origTo,origFrom:c.editFrom,origTo:c.editTo},g.style.top=m+"px","right"==q.type?g.style.left="2px":g.style.right="2px",g.setAttribute("role","button"))))}}}function Z(a,b){for(var c=0,e=0,g=0;g<b.length;g++){var f=b[g];if(f.editTo>a&&f.editFrom<=a)return null;if(f.editFrom>a)break;c=f.editTo;e=f.origTo}return e+(a-c)}function N(a,b,c){var e=
a.state.trackAlignable;a=a.firstLine();for(var g=0,f=[],h=0;;h++){for(var d=b[h],l=d?c?d.origFrom:d.editFrom:1E9;g<e.alignable.length;g+=2){var k=e.alignable[g]+1;if(!(k<=a)){if(!(k<=l))break;f.push(k)}}if(!d)break;f.push(a=c?d.origTo:d.editTo)}return f}function aa(a,b,c,e){var g=0,f=0,h=0,d=0;a:for(;;g++){var l=a[g],k=b[f];if(!l&&null==k)break;for(var m=l?l[0]:1E9,k=null==k?1E9:k;h<c.length;){var p=c[h];if(p.origFrom<=k&&p.origTo>k){f++;g--;continue a}if(p.editTo>m){if(p.editFrom<=m)continue a;break}d+=
p.origTo-p.origFrom-(p.editTo-p.editFrom);h++}m==k-d?(l[e]=k,f++):m<k-d?l[e]=m+d:((l=[k-d,null,null])[e]=k,a.splice(g,0,l),f++)}}function O(a,b){if(a.dealigned||b){if(!a.orig.curOp)return a.orig.operation(function(){O(a,b)});a.dealigned=!1;var c=a.mv.left==a?a.mv.right:a.mv.left;c&&(C(c),c.dealigned=!1);for(var e=function(a,c){var b=N(a.edit,a.chunks,!1),e=[];if(c)for(var d=0,f=0;d<c.chunks.length;d++){for(var g=c.chunks[d].editTo;f<b.length&&b[f]<g;)f++;f!=b.length&&b[f]==g||b.splice(f++,0,g)}for(d=
0;d<b.length;d++)e.push([b[d],null,null]);return aa(e,N(a.orig,a.chunks,!0),a.chunks,1),c&&aa(e,N(c.orig,c.chunks,!0),c.chunks,2),e}(a,c),g=a.mv.aligners,f=0;f<g.length;f++)g[f].clear();g.length=0;var h=[a.edit,a.orig],d=[],l=[];c&&h.push(c.orig);for(f=0;f<h.length;f++)d.push(h[f].getScrollInfo().top),l.push(-h[f].getScrollerElement().getBoundingClientRect().top);(l[0]!=l[1]||3==h.length&&l[1]!=l[2])&&ba(h,l,[0,0,0],g);for(c=0;c<e.length;c++)ba(h,l,e[c],g);for(f=0;f<h.length;f++)h[f].scrollTo(null,
d[f])}}function ba(a,b,c,e){for(var g,f=-1E8,h=[],d=0;d<a.length;d++)null!=c[d]&&(g=a[d].heightAtLine(c[d],"local")-b[d],h[d]=g,f=Math.max(f,g));for(var l,d=0;d<a.length;d++)null==c[d]||1<(l=f-h[d])&&e.push(function(a,c,b){var e=!0;c>a.lastLine()&&(c--,e=!1);var d=document.createElement("div");return d.className="CodeMirror-merge-spacer",d.style.height=b+"px",d.style.minWidth="1px",a.addLineWidget(c,d,{height:b,above:e,mergeSpacer:!0,handleMouseEvents:!0})}(a[d],c[d],l))}function ca(a,b,c,e){var g,
f,h,d;a.diffOutOfDate||(g=e.origTo>c.lastLine()?x(e.origFrom-1):x(e.origFrom,0),f=x(e.origTo,0),h=e.editTo>b.lastLine()?x(e.editFrom-1):x(e.editFrom,0),d=x(e.editTo,0),(e=a.mv.options.revertChunk)?e(a.mv,c,g,f,b,h,d):b.replaceRange(c.getRange(g,f),h,d))}function da(a){var b=a.lockButton=z("div",null,"CodeMirror-merge-scrolllock");b.setAttribute("role","button");var c=z("div",[b],"CodeMirror-merge-scrolllock-wrap");n.on(b,"click",function(){U(a,!a.lockScroll)});b=[c];return!1!==a.mv.options.revertButtons&&
(a.copyButtons=z("div",null,"CodeMirror-merge-copybuttons-"+a.type),n.on(a.copyButtons,"click",function(c){c=c.target||c.srcElement;c.chunk&&("CodeMirror-merge-copy-reverse"!=c.className?ca(a,a.edit,a.orig,c.chunk):ca(a,a.orig,a.edit,c.chunk))}),b.unshift(a.copyButtons)),"align"!=a.mv.options.connect&&((c=document.createElementNS&&document.createElementNS("http://www.w3.org/2000/svg","svg"))&&!c.createSVGRect&&(c=null),(a.svg=c)&&b.push(c)),a.gap=z("div",b,"CodeMirror-merge-gap")}function ea(a){return"string"==
typeof a?a:a.getValue()}function R(a,b,c){a=(fa=fa||new diff_match_patch).diff_main(a,b);for(b=0;b<a.length;++b){var e=a[b];(c?/[^ \t]/.test(e[1]):e[1])?b&&a[b-1][0]==e[0]&&(a.splice(b--,1),a[b][1]+=e[1]):a.splice(b--,1)}return a}function S(a){var b=[];if(!a.length)return b;for(var c=0,e=0,g=x(0,0),f=x(0,0),h=0;h<a.length;++h){var d,l,k,m,p=a[h],n=p[0];n==DIFF_EQUAL?(k=!W(a,h)||g.line<c||f.line<e?1:0,d=g.line+k,l=f.line+k,F(g,p[1],null,f),m=X(a,h)?1:0,k=g.line+m,m=f.line+m,d<k&&(h&&b.push({origFrom:e,
origTo:l,editFrom:c,editTo:d}),c=k,e=m)):F(n==DIFF_INSERT?g:f,p[1])}return(c<=g.line||e<=f.line)&&b.push({origFrom:e,origTo:f.line+1,editFrom:c,editTo:g.line+1}),b}function X(a,b){if(b==a.length-1)return 1;var c=a[b+1][1];return!(1==c.length&&b<a.length-2||10!=c.charCodeAt(0))&&(b==a.length-2||(1<(c=a[b+2][1]).length||b==a.length-3)&&10==c.charCodeAt(0))}function W(a,b){if(0==b)return 1;var c=a[b-1][1];return 10==c.charCodeAt(c.length-1)&&(1==b||10==(c=a[b-2][1]).charCodeAt(c.length-1))}function ga(a,
b,c,e){for(var g=0;g<a.chunks.length;g++)for(var f=a.chunks[g],h=f.editFrom-b;h<f.editTo+b;h++){var d=h+c;0<=d&&d<e.length&&(e[d]=!1)}}function z(a,b,c,e){a=document.createElement(a);if(c&&(a.className=c),e&&(a.style.cssText=e),"string"==typeof b)a.appendChild(document.createTextNode(b));else if(b)for(c=0;c<b.length;++c)a.appendChild(b[c]);return a}function G(a){for(var b=a.childNodes.length;0<b;--b)a.removeChild(a.firstChild)}function Y(a){for(var b=1;b<arguments.length;b+=2)a.setAttribute(arguments[b],
arguments[b+1])}function P(a,b){for(var c in b=b||{},a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function F(a,b,c,e){a=c?x(a.line,a.ch):a;for(c=0;;){var g=b.indexOf("\n",c);if(-1==g)break;++a.line;e&&++e.line;c=g+1}return a.ch=(c?0:a.ch)+(b.length-c),e&&(e.ch=(c?0:e.ch)+(b.length-c)),a}function Q(a){this.cm=a;this.alignable=[];this.height=a.doc.height;var b=this;a.on("markerAdded",function(a,e){!e.collapsed||null!=(e=e.find(1))&&b.set(e.line,H)});a.on("markerCleared",function(a,e,g,f){null!=f&&e.collapsed&&
b.check(f,H,b.hasMarker)});a.on("markerChanged",this.signal.bind(this));a.on("lineWidgetAdded",function(a,e,g){e.mergeSpacer||(e.above?b.set(g-1,A):b.set(g,ha))});a.on("lineWidgetCleared",function(a,e,g){e.mergeSpacer||(e.above?b.check(g-1,A,b.hasWidgetBelow):b.check(g,ha,b.hasWidget))});a.on("lineWidgetChanged",this.signal.bind(this));a.on("change",function(a,e){var g=e.from.line,f=e.to.line-e.from.line,h=e.text.length-1,d=g+h;(f||h)&&b.map(g,f,h);b.check(d,H,b.hasMarker);(f||h)&&b.check(e.from.line,
H,b.hasMarker)});a.on("viewportChange",function(){b.cm.doc.height!=b.height&&b.signal()})}function ia(a,b){var c=null,e=a.state.diffViews,g=a.getCursor().line;if(e)for(var f=0;f<e.length;f++){var h=e[f],d=a==h.orig;C(h);d=(0>b?function(a,c,b){for(var d=a.length-1;0<=d;d--){var e=a[d],e=(b?e.origTo:e.editTo)-1;if(e<c)return e}}:function(a,c,b){for(var d=0;d<a.length;d++){var e=a[d],e=b?e.origFrom:e.editFrom;if(c<e)return e}})(h.chunks,g,d);null==d||null!=c&&!(0>b?c<d:d<c)||(c=d)}if(null==c)return n.Pass;
a.setCursor(c,0)}var x=n.Pos,I=!(E.prototype={constructor:E,init:function(a,b,c){this.edit=this.mv.edit;(this.edit.state.diffViews||(this.edit.state.diffViews=[])).push(this);this.orig=n(a,P({value:b,readOnly:!this.mv.options.allowEditingOriginals},P(c)));"align"==this.mv.options.connect&&(this.edit.state.trackAlignable||(this.edit.state.trackAlignable=new Q(this.edit)),this.orig.state.trackAlignable=new Q(this.orig));this.lockButton.title=this.edit.phrase("Toggle locked scrolling");this.orig.state.diffViews=
[this];a=c.chunkClassLocation||"background";"[object Array]"!=Object.prototype.toString.call(a)&&(a=[a]);this.classes.classLocation=a;this.diff=R(ea(b),ea(c.value),this.mv.options.ignoreWhitespace);this.chunks=S(this.diff);this.diffOutOfDate=this.dealigned=!1;this.needsScrollSync=null;this.showDifferences=!1!==c.showDifferences},registerEvents:function(a){var b;this.forceUpdate=function(a){function b(d){p=!(I=!0);"full"==d&&(a.svg&&G(a.svg),a.copyButtons&&G(a.copyButtons),K(a.edit,k.marked,a.classes),
K(a.orig,m.marked,a.classes),k.from=k.to=m.from=m.to=0);C(a);a.showDifferences&&(V(a.edit,a.diff,k,DIFF_INSERT,a.classes),V(a.orig,a.diff,m,DIFF_DELETE,a.classes));"align"==a.mv.options.connect&&O(a);B(a);null!=a.needsScrollSync&&D(a,a.needsScrollSync);I=!1}function g(b){I||(a.dealigned=!0,f(b))}function f(a){I||p||(clearTimeout(l),!0===a&&(p=!0),l=setTimeout(b,!0===a?20:250))}function h(b,d){a.diffOutOfDate||(a.diffOutOfDate=!0,k.from=k.to=m.from=m.to=0);g(d.text.length-1!=d.to.line-d.from.line)}
function d(){a.diffOutOfDate=!0;a.dealigned=!0;b("full")}var l,k={from:0,to:0,marked:[]},m={from:0,to:0,marked:[]},p=!1;a.edit.on("change",h);a.orig.on("change",h);a.edit.on("swapDoc",d);a.orig.on("swapDoc",d);"align"==a.mv.options.connect&&(n.on(a.edit.state.trackAlignable,"realign",g),n.on(a.orig.state.trackAlignable,"realign",g));return a.edit.on("viewportChange",function(){f(!1)}),a.orig.on("viewportChange",function(){f(!1)}),b(),b}(this);U(this,!0,!1);(b=this).edit.on("scroll",function(){D(b,
!0)&&B(b)});b.orig.on("scroll",function(){D(b,!1)&&B(b);a&&D(a,!0)&&B(a)})},setShowDifferences:function(a){(a=!1!==a)!=this.showDifferences&&(this.showDifferences=a,this.forceUpdate("full"))}}),fa,J=n.MergeView=function(a,b){function c(){m&&B(m);p&&B(p)}if(!(this instanceof J))return new J(a,b);var e,g=(this.options=b).origLeft,f=null==b.origRight?b.orig:b.origRight,h=null!=g,d=null!=f,l=1+(h?1:0)+(d?1:0),k=[],m=this.left=null,p=this.right=null,w=this;h&&(m=this.left=new E(this,"left"),e=z("div",
null,"CodeMirror-merge-pane CodeMirror-merge-left"),k.push(e),k.push(da(m)));var u,h=z("div",null,"CodeMirror-merge-pane CodeMirror-merge-editor");k.push(h);d&&(p=this.right=new E(this,"right"),k.push(da(p)),u=z("div",null,"CodeMirror-merge-pane CodeMirror-merge-right"),k.push(u));(d?u:h).className+=" CodeMirror-merge-pane-rightmost";k.push(z("div",null,null,"height: 0; clear: both;"));var A=this.wrap=a.appendChild(z("div",k,"CodeMirror-merge CodeMirror-merge-"+l+"pane"));this.edit=n(h,P(b));m&&m.init(e,
g,b);p&&p.init(u,f,b);b.collapseIdentical&&this.editor().operation(function(){!function(a,b){"number"!=typeof b&&(b=2);for(var c=[],d=a.editor(),e=d.firstLine(),f=e,g=d.lastLine();f<=g;f++)c.push(!0);a.left&&ga(a.left,b,e,c);a.right&&ga(a.right,b,e,c);for(f=0;f<c.length;f++)if(c[f]){for(var h,g=f+e,k=1;f<c.length-1&&c[f+1];f++,k++);b<k&&(h=[{line:g,cm:d}],a.left&&h.push({line:Z(g,a.left.chunks),cm:a.left.orig}),a.right&&h.push({line:Z(g,a.right.chunks),cm:a.right.orig}),h=function(a,b){function c(){for(var a=
0;a<d.length;a++)d[a].clear()}for(var d=[],e=0;e<b.length;e++){var f=b[e],f=function(a,b,c){function d(){f.clear();a.removeLineClass(b,"wrap","CodeMirror-merge-collapsed-line")}a.addLineClass(b,"wrap","CodeMirror-merge-collapsed-line");var e=document.createElement("span");e.className="CodeMirror-merge-collapsed-widget";e.title=a.phrase("Identical text collapsed. Click to expand.");var f=a.markText(x(b,0),x(c-1),{inclusiveLeft:!0,inclusiveRight:!0,replacedWith:e,clearOnEnter:!0});f.explicitlyCleared&&
d();return n.on(e,"click",d),f.on("clear",d),n.on(e,"click",d),{mark:f,clear:d}}(f.cm,f.line,f.line+a);d.push(f);f.mark.on("clear",c)}return d[0].mark}(k,h),a.options.onCollapse&&a.options.onCollapse(a,g,k,h))}}(w,b.collapseIdentical)});"align"==b.connect&&(this.aligners=[],O(this.left||this.right,!0));m&&m.registerEvents(p);p&&p.registerEvents(m);n.on(window,"resize",c);var r=setInterval(function(){for(var a=A.parentNode;a&&a!=document.body;a=a.parentNode);a||(clearInterval(r),n.off(window,"resize",
c))},5E3)};J.prototype={constructor:J,editor:function(){return this.edit},rightOriginal:function(){return this.right&&this.right.orig},leftOriginal:function(){return this.left&&this.left.orig},setShowDifferences:function(a){this.right&&this.right.setShowDifferences(a);this.left&&this.left.setShowDifferences(a)},rightChunks:function(){if(this.right)return C(this.right),this.right.chunks},leftChunks:function(){if(this.left)return C(this.left),this.left.chunks}};var ha=1,A=2,H=4;Q.prototype={signal:function(){n.signal(this,
"realign");this.height=this.cm.doc.height},set:function(a,b){for(var c=-1;c<this.alignable.length;c+=2){var e=this.alignable[c]-a;if(0==e)return(this.alignable[c+1]&b)==b?void 0:(this.alignable[c+1]|=b,void this.signal());if(0<e)break}this.signal();this.alignable.splice(c,0,a,b)},find:function(a){for(var b=0;b<this.alignable.length;b+=2)if(this.alignable[b]==a)return b;return-1},check:function(a,b,c){var e=this.find(a);-1!=e&&this.alignable[e+1]&b&&(c.call(this,a)||(this.signal(),(b=this.alignable[e+
1]&~b)?this.alignable[e+1]=b:this.alignable.splice(e,2)))},hasMarker:function(a){a=this.cm.getLineHandle(a);if(a.markedSpans)for(var b=0;b<a.markedSpans.length;b++)if(a.markedSpans[b].marker.collapsed&&null!=a.markedSpans[b].to)return!0;return!1},hasWidget:function(a){a=this.cm.getLineHandle(a);if(a.widgets)for(var b=0;b<a.widgets.length;b++)if(!a.widgets[b].above&&!a.widgets[b].mergeSpacer)return!0;return!1},hasWidgetBelow:function(a){if(a==this.cm.lastLine())return!1;a=this.cm.getLineHandle(a+1);
if(a.widgets)for(var b=0;b<a.widgets.length;b++)if(a.widgets[b].above&&!a.widgets[b].mergeSpacer)return!0;return!1},map:function(a,b,c){for(var e=c-b,g=a+b,f=-1,h=-1,d=0;d<this.alignable.length;d+=2){var l=this.alignable[d];l==a&&this.alignable[d+1]&A&&(f=d);l==g&&this.alignable[d+1]&A&&(h=d);l<=a||(l<g?this.alignable.splice(d--,2):this.alignable[d]+=e)}-1<f&&((b=this.alignable[f+1])==A?this.alignable.splice(f,2):this.alignable[f+1]=b&~A);-1<h&&c&&this.set(a+c,A)}};n.commands.goNextDiff=function(a){return ia(a,
1)};n.commands.goPrevDiff=function(a){return ia(a,-1)}});